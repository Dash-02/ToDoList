[
  {
    "Title": "using Newtonsoft.Json;\r\nusing System;\r\nusing System.Collections.Generic;\r\nusing System.IO;\r\nusing System.Windows.Forms;\r\n\r\nnamespace EisenhowerMatrix\r\n{\r\n    public partial class DoneTasks : Form\r\n    {\r\n        private List<Task> completedTasks;  \r\n        private List<Task> completedTasks2;\r\n\r\n        public List<Task> CompletedTasks { get; internal set; }\r\n\r\n        public DoneTasks(List<Task> completedTasks)\r\n        {\r\n            InitializeComponent();\r\n            this.completedTasks2 = completedTasks;\r\n            completedTasks = new List<Task>();  // Initialize the list only once\r\n            LoadCompletedTasks();\r\n            SaveCompletedTasks();\r\n            UpdateCompletedTasks();\r\n            label1.Text = $\"Выполненные задачи: {completedTasks2.Count}\";\r\n        }\r\n\r\n        private void LoadCompletedTasks()\r\n        {\r\n            if (File.Exists(\"tasks.json\"))\r\n            {\r\n                string json = File.ReadAllText(\"tasks.json\");\r\n                if (!string.IsNullOrEmpty(json))\r\n                {\r\n                    completedTasks = JsonConvert.DeserializeObject<List<Task>>(json);\r\n                }\r\n            }\r\n        }\r\n\r\n        private void UpdateCompletedTasks()\r\n        {\r\n            listBox1.Items.Clear();\r\n            foreach (Task task in completedTasks)\r\n            {\r\n                if (task.IsCompleted)\r\n                {\r\n                    listBox1.Items.Add(task);\r\n                }\r\n            }\r\n        }\r\n\r\n        private void SaveCompletedTasks()\r\n        {\r\n            string json = JsonConvert.SerializeObject(completedTasks2);\r\n            File.WriteAllText(\"tasks.json\", json);\r\n        }\r\n\r\n        private void btn_home_Click(object sender, EventArgs e)\r\n        {\r\n            Close();\r\n        }\r\n\r\n        private void btn_done_Click(object sender, EventArgs e)\r\n        {\r\n            Refresh();\r\n        }\r\n\r\n        private void CopyToolStripMenu_Click(object sender, EventArgs e)\r\n        {\r\n            ToolStripMenuItem menuItem = (ToolStripMenuItem)sender;\r\n            ContextMenuStrip menu = (ContextMenuStrip)menuItem.Owner;\r\n            Control sourceControl = menu.SourceControl;\r\n\r\n            if (sourceControl is ListBox listBox)\r\n            {\r\n                if (listBox.SelectedItem is Task selectedTask)\r\n                {\r\n                    Clipboard.SetText(selectedTask.Title);\r\n                }\r\n            }\r\n        }\r\n\r\n        private void DeleteToolStripMenu_Click(object sender, EventArgs e)\r\n        {\r\n            ToolStripMenuItem toolStripMenuItem = (ToolStripMenuItem)sender;\r\n            if (toolStripMenuItem.GetCurrentParent() is ContextMenuStrip contextMenuStrip && contextMenuStrip.SourceControl is ListBox listBox)\r\n            {\r\n                if (listBox.SelectedItem is Task selectedTask)\r\n                {\r\n                    completedTasks.Remove(selectedTask);\r\n                    UpdateCompletedTasks();\r\n                    SaveCompletedTasks();\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n",
    "Priority": "Важно-срочно",
    "IsCompleted": false
  },
  {
    "Title": "using Newtonsoft.Json;\r\nusing System;\r\nusing System.Collections.Generic;\r\nusing System.IO;\r\nusing System.Windows.Forms;\r\n\r\nnamespace EisenhowerMatrix\r\n{\r\n    public partial class DoneTasks : Form\r\n    {\r\n        private List<Task> completedTasks;  \r\n        private List<Task> completedTasks2;\r\n\r\n        public List<Task> CompletedTasks { get; internal set; }\r\n\r\n        public DoneTasks(List<Task> completedTasks)\r\n        {\r\n            InitializeComponent();\r\n            this.completedTasks2 = completedTasks;\r\n            completedTasks = new List<Task>();  // Initialize the list only once\r\n            LoadCompletedTasks();\r\n            SaveCompletedTasks();\r\n            UpdateCompletedTasks();\r\n            label1.Text = $\"Выполненные задачи: {completedTasks2.Count}\";\r\n        }\r\n\r\n        private void LoadCompletedTasks()\r\n        {\r\n            if (File.Exists(\"tasks.json\"))\r\n            {\r\n                string json = File.ReadAllText(\"tasks.json\");\r\n                if (!string.IsNullOrEmpty(json))\r\n                {\r\n                    completedTasks = JsonConvert.DeserializeObject<List<Task>>(json);\r\n                }\r\n            }\r\n        }\r\n\r\n        private void UpdateCompletedTasks()\r\n        {\r\n            listBox1.Items.Clear();\r\n            foreach (Task task in completedTasks)\r\n            {\r\n                if (task.IsCompleted)\r\n                {\r\n                    listBox1.Items.Add(task);\r\n                }\r\n            }\r\n        }\r\n\r\n        private void SaveCompletedTasks()\r\n        {\r\n            string json = JsonConvert.SerializeObject(completedTasks2);\r\n            File.WriteAllText(\"tasks.json\", json);\r\n        }\r\n\r\n        private void btn_home_Click(object sender, EventArgs e)\r\n        {\r\n            Close();\r\n        }\r\n\r\n        private void btn_done_Click(object sender, EventArgs e)\r\n        {\r\n            Refresh();\r\n        }\r\n\r\n        private void CopyToolStripMenu_Click(object sender, EventArgs e)\r\n        {\r\n            ToolStripMenuItem menuItem = (ToolStripMenuItem)sender;\r\n            ContextMenuStrip menu = (ContextMenuStrip)menuItem.Owner;\r\n            Control sourceControl = menu.SourceControl;\r\n\r\n            if (sourceControl is ListBox listBox)\r\n            {\r\n                if (listBox.SelectedItem is Task selectedTask)\r\n                {\r\n                    Clipboard.SetText(selectedTask.Title);\r\n                }\r\n            }\r\n        }\r\n\r\n        private void DeleteToolStripMenu_Click(object sender, EventArgs e)\r\n        {\r\n            ToolStripMenuItem toolStripMenuItem = (ToolStripMenuItem)sender;\r\n            if (toolStripMenuItem.GetCurrentParent() is ContextMenuStrip contextMenuStrip && contextMenuStrip.SourceControl is ListBox listBox)\r\n            {\r\n                if (listBox.SelectedItem is Task selectedTask)\r\n                {\r\n                    completedTasks.Remove(selectedTask);\r\n                    UpdateCompletedTasks();\r\n                    SaveCompletedTasks();\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n",
    "Priority": "Важно-не-срочно",
    "IsCompleted": false
  }
]